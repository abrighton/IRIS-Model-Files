subsystem = IRIS
component = imager-detector-assembly

publish {
	telemetry = [
		{
			name = currentConfig
	    	description = "Configuration of exposure (or a successive sequence of exposures) in progress or last completed"
	    	minRate = 1
	    	maxRate = 1
	    	archive = true
	    	archiveRate = 1
	    	attributes = [
	    		{
	    			name = samplingMode
	    			description  = "Sampling mode."
	    			enum = [CDS, Fowler, UTR, TBD] 
	    			default = CDS
	    		}
	    		{
	    			name = pixelTime
	    			description  = "Time to select and read one pixel."
	    			type = float
	    			units = us
	    		}
	    		{
	    			name = channels
	    			description  = "Number of channels. The possible numbers are 1, 4, 16, 32, 64 (TBC)."
	    			type = integer
	    			minimum = 1
				maximum = 64
	    			units = channels
	    		}
	    		{
	    			name = frameTime
	    			description  = """Time to read the whole array for one readout.

__TBD__: Check if this is the same as the reset time.
__TBD__: Consider the impact of ODGW.
"""
	    			type = float
	    			units = us
	    		}
	    		{
	    			name = intergrationTime
	    			description  = "Integration time. In case of CDS and Fowler sampling, this integration time is the time between two groups."
	    			type = integer
	    			minimum = 0 
	    			units = ms
	    		}
	    		{
	    			name = resets
	    			description = "Number of resets in one ramp."
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = groups
	    			description = """Number of groups in one ramp.

__DISCUSSION__: Do we need this parameter? This is fixed to 2 in case of CDS and Fowler sampling, and this value does not make sense for the other type of sampling methods.
"""
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = reads
	    			description = "Number of reads in one group."
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = coadds
	    			description = "Number of coadds in one exposure."
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = repeats
	    			description = "Number of exposures repeatedly executed with the same configuration."
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = subregionStartX1
	    			description = "Leftmost column(0-based) pixel of subregion of detector #1."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartY1
	    			description = "Bottommost row(0-based) pixel of subregion of detector #1."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndX1
	    			description = "Rightmost column(0-based) pixel of subregion of detector #1."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndY1
	    			description = "Topmost row(0-based) pixel of subregion of detector #1."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartX2
	    			description = "Leftmost column(0-based) pixel of subregion of detector #2."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartY2
	    			description = "Bottommost row(0-based) pixel of subregion of detector #2."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndX2
	    			description = "Rightmost column(0-based) pixel of subregion of detector #2."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndY2
	    			description = "Topmost row(0-based) pixel of subregion of detector #2."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartX3
	    			description = "Leftmost column(0-based) pixel of subregion of detector #3."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartY3
	    			description = "Bottommost row(0-based) pixel of subregion of detector #3."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndX3
	    			description = "Rightmost column(0-based) pixel of subregion of detector #3."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndY3
	    			description = "Topmost row(0-based) pixel of subregion of detector #3."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartX4
	    			description = "Leftmost column(0-based) pixel of subregion of detector #4."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartY4
	    			description = "Bottommost row(0-based) pixel of subregion of detector #4."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndX4
	    			description = "Rightmost column(0-based) pixel of subregion of detector #4."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndY4
	    			description = "Topmost row(0-based) pixel of subregion of detector #4."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = versionDSP
	    			description = """Version number of downloaded DSP code in Leach controller.

__TBD__: We may need more attributes for other software components outside CSW scheme. We first need to identify what kind of software components would be reuiqred for detector control.
"""
	    			type = string
	    		}
	    		{
	    			name = versionDriver
	    			description = "Version number of Linux driver for Leach controller."
	    			type = string
	    		}
	    		{
	    			name = versionAPI
	    			description = "Version number of ARC API."
	    			type = string
	    		}
	    	]
    	}
    	{
			name = nextConfig
	    	description = "Configuration of next exposure to be taken"
	    	minRate = 1
	    	maxRate = 1
	    	archive = true
	    	archiveRate = 1
	    	attributes = [
	    		{
	    			name = samplingMode
	    			description  = "Sampling mode."
	    			enum = [CDS, Fowler, UTR, TBD] 
	    			default = CDS
	    		}
	    		{
	    			name = pixelTime
	    			description  = "Time to select and read one pixel."
	    			type = float
	    			units = us
	    		}
	    		{
	    			name = channels
	    			description  = "Number of channels. The possible numbers are 1, 4, 16, 32, 64 (TBC)."
	    			type = integer
	    			minimum = 1
				maximum = 64
	    			units = channels
	    		}
	    		{
	    			name = intergrationTime
	    			description  = "Integration time. In case of CDS and Fowler sampling, this integration time is the time between two groups."
	    			type = integer
	    			minimum = 0 
	    			units = ms
	    		}
	    		{
	    			name = resets
	    			description = "Number of resets in one ramp."
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = groups
	    			description = """Number of groups in one ramp.

__DISCUSSION__: Do we need this parameter? This is fixed to 2 in case of CDS and Fowler sampling, and this value does not make sense for the other type of sampling methods.
"""
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = reads
	    			description = "Number of reads in one group."
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = coadds
	    			description = "Number of coadds in one exposure."
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = repeats
	    			description = "Number of exposures repeatedly executed with the same configuration."
	    			type = integer
	    			minimum = 1
	    			default = 1
	    		}
	    		{
	    			name = subregionStartX1
	    			description = "Leftmost column(0-based) pixel of subregion of detector #1."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartY1
	    			description = "Bottommost row(0-based) pixel of subregion of detector #1."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndX1
	    			description = "Rightmost column(0-based) pixel of subregion of detector #1."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndY1
	    			description = "Topmost row(0-based) pixel of subregion of detector #1."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartX2
	    			description = "Leftmost column(0-based) pixel of subregion of detector #2."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartY2
	    			description = "Bottommost row(0-based) pixel of subregion of detector #2."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndX2
	    			description = "Rightmost column(0-based) pixel of subregion of detector #2."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndY2
	    			description = "Topmost row(0-based) pixel of subregion of detector #2."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartX3
	    			description = "Leftmost column(0-based) pixel of subregion of detector #3."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartY3
	    			description = "Bottommost row(0-based) pixel of subregion of detector #3."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndX3
	    			description = "Rightmost column(0-based) pixel of subregion of detector #3."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndY3
	    			description = "Topmost row(0-based) pixel of subregion of detector #3."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartX4
	    			description = "Leftmost column(0-based) pixel of subregion of detector #4."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionStartY4
	    			description = "Bottommost row(0-based) pixel of subregion of detector #4."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 0
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndX4
	    			description = "Rightmost column(0-based) pixel of subregion of detector #4."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = subregionEndY4
	    			description = "Topmost row(0-based) pixel of subregion of detector #4."
	    			type = integer
	    			minimum = 0
	    			maximum = 4095
	    			default = 4095
	    			units = pixel
	    		}
	    		{
	    			name = versionDSP
	    			description = """Version number of downloaded DSP code in Leach controller.

__TBD__: We may need more attributes for other software components outside CSW scheme. We first need to identify what kind of software components would be reuiqred for detector control.
"""
	    			type = string
	    		}
	    		{
	    			name = versionDriver
	    			description = "Version number of Linux driver for Leach controller."
	    			type = string
	    		}
	    		{
	    			name = versionAPI
	    			description = "Version number of ARC API."
	    			type = string
	    		}
	    	]
    	}
    	{
	    	name = referencePixelSubtraction
	    	description = "Status of reference pixel subtraction"
	    	minRate = 1
	    	maxRate = 1
	    	archive = true
	    	archiveRate = 1
	    	attributes = [
	    		{
	    			name = performed
	    			description  = "Flag for whether reference pixel subtraction is performed"
	    			type = boolean
	    			default = TRUE
	    		}
	    		{
	    			name = type
	    			description  = "Type of reference pixel subtraction performed"
	    			enum = [TBD1, TBD2, TBD3]
	    			default = TBD1
	    		}	    		
	    	]
	    }
	    {
	    	name = gain
	    	minRate = 1
	      	maxRate = 1
	    	archive = true
	    	archiveRate = 1
	    	attributes = [
	    		{
	    			name = gain
	    			description = "Convsersion of photoelectrons to counts"
	    			type = float
	    			units = e-/ADU
	    			
	    		}
	    	]
	    }	    
	    {
	    	name = status
	    	minRate = 1
	      	maxRate = 1
	    	archive = true
	    	archiveRate = 1
	    	attributes = [
	    		{
	    			name = status
	    			description = "Overall status of system:"
	    			type = string
	    			default = UNKNOWN
	    			
	    		}
	    		{
	    			name = statusDetail
	    			description = "Detailed status of system:"
	    			type = string
	    			default = UNKNOWN
	    			
	    		}
	    	]
	    }
	    {
	    	name = flags
	    	minRate = 1
	    	maxRate = 1
	    	archive = true
	    	archiveRate = 1
	    	attributes = [
	    		{
	    			name = isAborted
	    			description = "Flag for whether exposure in progress or last completed exposure has been aborted"
	    			type = boolean
	    			default = FALSE
	    		}
	    		{
	    			name = abortInProgress
	    			description = "Flag for whether exposure in progress is currently being aborted"
	    			type = boolean
	    			default = FALSE
	    		}
	    		{
	    			name = observationInProgress
	    			description = "Flag for whether an observation is in progress"
	    			type = boolean
	    			default = FALSE
	    		}
	    		{
	    			name = exposureInProgress
	    			description = "Flag for whether exposure is in progress"
	    			type = boolean
	    			default = FALSE
	    		}
	    	]
	    }
	    {
	    	name = counts
	    	minRate = 1
	    	maxRate = 1
	    	archive = true
	    	archiveRate = 1
	    	attributes = [
	    		{
	    			name = readsDone
	    			description = "Number of reads completed for exposure in progress or last completed"
	    			type = integer
	    			minimum = 0
	    			default = 0
	    		}
	    		{
	    			name = groups
	    			description = "Number of groups completed for exposure in progress or last completed"
	    			type = integer
	    			minimum = 0
	    			default = 0
	    		}
	    		{
	    			name = coaddsDone
	    			description = "Number of coadds completed for exposure in progress or last completed"
	    			type = integer
	    			minimum = 0
	    			default = 0
	    		}
	    		{
	    			name = repeatsDone
	    			description = "Number of exposure repeats completed for exposure in progress or last completed"
	    			type = integer
	    			minimum = 0
	    			default = 0
	    		}
	    	]
	    }
	    
  	]
}