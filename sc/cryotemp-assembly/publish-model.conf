subsystem = IRIS
component = cryotemp-assembly

publish {
	telemetry = [
    	{
    	name = "sensor"
    	description = "Telemetry of the telemetry sensor"
      	minRate = 1
      	maxRate = 1
      	archive = true
    	attributes = [
    		{
    		name = "sensorID"
    		description = "Temperature sensor ID of the hardware"
		    type = string
		    }
    		{
    		name = "location"
    		description = "Location description of the temperature sensor"
		    type = string
    		}
    		{
    		name = "unit"
    		description = "Temperature unit"
		    enum = [K, C, Sensor, Linear] 
		    default = K
    		}
    		{
    		name = "reading"
    		description = "Temperature reading according to the unit"
    		type = float
    		}
    		{
    		name = "sensorreadingstatus"
    		description  = "Bit weighting of sensor status flags. 1=invalid reading, 2=old reading, 16=temp underrange, 32=temp overrange, 64=units zero, 128= units overrarnge"
    		units = integer
    		default = 0
    		}
    		{
    		name = "highalarmstatus"
    		description = "Alarm status for highest value"
    		type = boolean
    		default = false
    		}
    		{
    		name = "lowalarmstatus"
    		description = "Alarm status for lowest value"
    		type = boolean
    		default = false
    		}
    		{
    		name = "min"
    		description = "Minimum temperature during current session"
    		type = float
    		}
    		{
    		name = "max"
    		description = "Maximum temperature during current session"
    		type = float
    		}
    		{
    		name = "minmaxstatus"
    		description  = "Bit weighting of min/max status flags. 1=invalid reading, 2=old reading, 16=temp underrange, 32=temp overrange, 64=units zero, 128= units overrarnge"
			type = array
			dimensions = [2]
            items = {
                    type = integer
                    minimum = 0
                    maximum = 512
            		}    		
    		}
    	]
    	}
    	{
    	name = "controlloop"
    		attributes = [
    		{
    		name = "loopID"
    		description = "Control loop ID of the hardware"
    		type = string
    		}
    		{
    		name = "setpoint"
    		description  = "current setpoint of control loop."
    		type = float
    		}
    		{
    		name = "heater_range"
    		description = "heater range. The power of the heater is decided by heater resistance, heater range, and maximum current."
    		type = int
    		minimum = 1
    		maximum = 5
    		default = 1
    		}
    		{
    		name = "input"
    		description  = "Input this loop to control from."
    		enum = [A, B]    		
    		}
    		{
    		name = "units"
    		description  = "Setpoint unit"
    		enum = [K, C, Sensor]
    		}
    		{
    		name = "onoff"
    		description = "On/Off flag of this control loop."
    		type = boolean
    		default = false
    		}
    		{
    		name = "powerup_enable"
    		description  = "Flag specifying whether the control loop is on or off after power up."
    		type = boolean
    		default = false
    		}
    		{
    		name = "filter_onoff"
    		description = "On/Off flag of this control loop filter. It uses the same filter window and number of filter points as input."
    		type = boolean
    		default = false
    		}
    		{
    		name = "mode"
    		description  = "Control loop PID mode. 1 = Manual PID, 2 = Zone, 3 = Open Loop, 4 = Autotune PID, 5 = AutoTune PI, 6 = AutoTune P"
    		type = int
    		minimum = 1
    		maximum = 6
    		}
    		{
    		name = "pid"
    		description  = "PID values for this control loop"
    		type = array
    		dimension = [3]
    		items = {
                type = integer
                }    		
    		}    		
    		{
    		name = "ramp_onoff"
    		description = "On/Off flag of the ramp control"
    		type = boolean
    		default = false
    		}
    		{
    		name = "ramp_value"
    		description  = "How many kelvin per minute to ramp the setpoint"
    		type = float
    		}
    	]
    	}
    	{
    	name = "heater_output"
    	attributes = [
    		{
    		name = "output"
    		}
    		{
    		name = "percent"
    		}
    		{
    		name = "status"
    		}
    	}
    	{
      	name = "status"
      	description = "Overall status of tepmerature assembly."
      	minRate = 1
      	maxRate = 1
      	archive = true
      	attributes = [
       	 	{
	  		name = unlockAllowed
	  		description = """
				Indicats if mechanisms and detectors can be unlocked.

				__TBD__: Consider whether this is really needed.
			"""
	  		type = boolean
	 		default = false
        	}
      	]
    	}
    ]
	event = [
		{
    	name = "alarm_config"
    	attributes = [
    		{
    		name = "input"
    		}
    		{
    		name = "onoff"
    		}
    		{
    		name = "source"
    		}
    		{
    		name = "highvalue"
    		}
    		{
    		name = "lowvalue"
    		}
    		{
    		name = "latchenable"
    		}
    		{
    		name = "relay"
    		}
    	]	
    	}
    	{
    	name = "fileter_config"
    	attributes = [
    		{
    		name = "input"
    		}
    		{
    		name = "onoff"
    		}
    		{
    		name = "points"
    		}
    		{
    		name = "window"
    		}
    	]
    	}
    	{
    	name = "inputmodetype_ config"
    	attributes = [
    		{
    		name = "input"
    		}
    		{
    		name = "curve"
    		}
    		{
    		name = "enable"
    		}
    		{
    		name = "compensation"
    		}
    		{
    		name = "type"
    		}
    		{
    		name = "unit"
    		}
    		{
    		name = "coefficient"
    		}
    		{
    		name = "excitation"
    		}
    		{
    		name = "range"
    		}
    	]
    	}
    	{
    	name = "linearequation_config"
    	attributes = [
    		{
    		name = "input"
    		}
    		{
    		name = "equation"
    		}
    		{
    		name = "varMvalue"
    		}
    		{
    		name = "xsource"
    		}
    		{
    		name = "bsource"
    		}
    		{
    		name = "varBvalue"
    		}
    	]
    	}
    	{
    	name = "controllooplimit_config"
    		attributes = [
    		{
    		name = "loop"
    		}
    		{
    		name = "setpointlimit"
    		}
    		{
    		name = "positiveslope"
    		}
    		{
    		name = "negativeslope"
    		}
    		{
    		name = "maxcurrent"
    		}
    		{
    		name = "maxrange"
    		}
    	]
    	}
    ]
}    	